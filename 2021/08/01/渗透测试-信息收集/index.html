<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>渗透测试-信息收集 | 临渊羡鱼</title><meta name="description" content="## 1. 基础概念  域名域名互联网上某一台计算机或计算机组的名称，用于在数据传输时标识计算机的电子方位（有时也指地理位置）。 网域名称系统网域名称系统（Domain Name System）有时也简称为域名（DNS），是互联网的一项核心服务，它作为可以将域名和 IP 地址相互映射的一个分布式数据库。 二级域名或多级域名顶级域名 又叫一级域名，一串字符串中间一个点隔开，例如baidu.com"><meta name="keywords" content="网络安全,Web安全,渗透测试"><meta name="author" content="BoneInk"><meta name="copyright" content="BoneInk"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/R.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="渗透测试-信息收集"><meta name="twitter:description" content="## 1. 基础概念  域名域名互联网上某一台计算机或计算机组的名称，用于在数据传输时标识计算机的电子方位（有时也指地理位置）。 网域名称系统网域名称系统（Domain Name System）有时也简称为域名（DNS），是互联网的一项核心服务，它作为可以将域名和 IP 地址相互映射的一个分布式数据库。 二级域名或多级域名顶级域名 又叫一级域名，一串字符串中间一个点隔开，例如baidu.com"><meta name="twitter:image" content="https://https://www.wallpaperup.com/uploads/wallpapers/2014/09/25/455966/2587c9e290e4776a126065c9eeb18090.jpg"><meta property="og:type" content="article"><meta property="og:title" content="渗透测试-信息收集"><meta property="og:url" content="https://boneink.github.io/2021/08/01/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"><meta property="og:site_name" content="临渊羡鱼"><meta property="og:description" content="## 1. 基础概念  域名域名互联网上某一台计算机或计算机组的名称，用于在数据传输时标识计算机的电子方位（有时也指地理位置）。 网域名称系统网域名称系统（Domain Name System）有时也简称为域名（DNS），是互联网的一项核心服务，它作为可以将域名和 IP 地址相互映射的一个分布式数据库。 二级域名或多级域名顶级域名 又叫一级域名，一串字符串中间一个点隔开，例如baidu.com"><meta property="og:image" content="https://https://www.wallpaperup.com/uploads/wallpapers/2014/09/25/455966/2587c9e290e4776a126065c9eeb18090.jpg"><meta property="article:published_time" content="2021-08-01T04:00:00.000Z"><meta property="article:modified_time" content="2021-08-01T04:00:00.000Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://boneink.github.io/2021/08/01/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"><link rel="prev" title="渗透测试-信息收集" href="https://boneink.github.io/2021/08/10/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-SQL%E6%B3%A8%E5%85%A5-WAF%E7%BB%95%E8%BF%87/"><link rel="next" title="Web安全-XSS攻击渗透报告" href="https://boneink.github.io/2021/07/13/Web%E5%AE%89%E5%85%A8-XSS%E6%94%BB%E5%87%BB%E6%B8%97%E9%80%8F%E6%8A%A5%E5%91%8A/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: true
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="临渊羡鱼" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="http://q1.qlogo.cn/g?b=qq&amp;nk=1214424001&amp;s=5" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">60</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">33</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D"><span class="toc-number">1.</span> <span class="toc-text">域名</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D-1"><span class="toc-number">1.1.</span> <span class="toc-text">域名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E5%9F%9F%E5%90%8D%E7%A7%B0%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.2.</span> <span class="toc-text">网域名称系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E7%BA%A7%E5%9F%9F%E5%90%8D%E6%88%96%E5%A4%9A%E7%BA%A7%E5%9F%9F%E5%90%8D"><span class="toc-number">1.3.</span> <span class="toc-text">二级域名或多级域名</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS"><span class="toc-number">2.</span> <span class="toc-text">DNS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0Hosts%E4%B8%8EDNS%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">2.1.</span> <span class="toc-text">本地Hosts与DNS的关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CDN%E6%98%AF%E4%BB%80%E4%B9%88-%E4%B8%8EDNS%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">2.2.</span> <span class="toc-text">CDN是什么?与DNS的关系?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84DNS%E5%AE%89%E5%85%A8%E6%94%BB%E5%87%BB"><span class="toc-number">2.3.</span> <span class="toc-text">常见的DNS安全攻击</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E9%97%A8"><span class="toc-number">3.</span> <span class="toc-text">后门</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web"><span class="toc-number">4.</span> <span class="toc-text">web</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E5%8C%85%E6%89%A9%E5%B1%95"><span class="toc-number"></span> <span class="toc-text">2. 数据包扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#http-x2F-https%E6%95%B0%E6%8D%AE%E5%8C%85"><span class="toc-number">1.</span> <span class="toc-text">http&#x2F;https数据包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URI%E5%92%8CURL%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.</span> <span class="toc-text">URI和URL的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E6%8A%A5%E6%96%87%E7%BB%84%E6%88%90"><span class="toc-number">3.</span> <span class="toc-text">HTTP报文组成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95"><span class="toc-number">4.</span> <span class="toc-text">常见请求方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTPS"><span class="toc-number">5.</span> <span class="toc-text">HTTPS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E7%B3%BB%E7%BB%9F%E5%8F%8A%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8"><span class="toc-number"></span> <span class="toc-text">3. 系统及数据库安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B1%82%E9%9D%A2"><span class="toc-number">1.</span> <span class="toc-text">数据库层面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B1%82%E9%9D%A2"><span class="toc-number">2.</span> <span class="toc-text">第三方层面</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%AE%97%E6%B3%95"><span class="toc-number"></span> <span class="toc-text">4. 加密编码算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-CDN%E7%BB%95%E8%BF%87"><span class="toc-number"></span> <span class="toc-text">5. CDN绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E3%80%81WAF"><span class="toc-number"></span> <span class="toc-text">6. 信息收集、WAF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%99%E7%82%B9%E6%90%AD%E5%BB%BA%E5%88%86%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text">站点搭建分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WAF"><span class="toc-number">2.</span> <span class="toc-text">WAF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%B5%84%E4%BA%A7%E6%94%B6%E9%9B%86"><span class="toc-number"></span> <span class="toc-text">7. 资产收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-web%E6%BC%8F%E6%B4%9E"><span class="toc-number"></span> <span class="toc-text">8. web漏洞</span></a></div></div></div><div id="body-wrap"><div id="web_bg" data-type="color"></div><div class="post-bg" id="nav" style="background-image: url(https://https://www.wallpaperup.com/uploads/wallpapers/2014/09/25/455966/2587c9e290e4776a126065c9eeb18090.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">临渊羡鱼</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">渗透测试-信息收集</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2021-08-01 12:00:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2021-08-01</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2021-08-01 12:00:00"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2021-08-01</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"> <img src="https://boneink.github.io/img/netsafe/信息收集.png" />
## 1. 基础概念

<h3 id="域名"><a href="#域名" class="headerlink" title="域名"></a>域名</h3><h4 id="域名-1"><a href="#域名-1" class="headerlink" title="域名"></a>域名</h4><p>互联网上某一台计算机或计算机组的名称，用于在数据传输时标识计算机的电子方位（有时也指地理位置）。</p>
<h4 id="网域名称系统"><a href="#网域名称系统" class="headerlink" title="网域名称系统"></a>网域名称系统</h4><p>网域名称系统（Domain Name System）有时也简称为域名（DNS），是互联网的一项核心服务，它作为可以将域名和 IP 地址相互映射的一个分布式数据库。</p>
<h4 id="二级域名或多级域名"><a href="#二级域名或多级域名" class="headerlink" title="二级域名或多级域名"></a>二级域名或多级域名</h4><p><strong>顶级域名</strong></p>
<p>又叫一级域名，一串字符串中间<strong>一个点</strong>隔开，例如baidu.com。顶级域名是互联网DNS等级之中的最高级的域，它保存于DNS根域的名字空间中。</p>
<p><strong>二级域名</strong></p>
<p>实际上就是一个一级域名以下的主机名，一串字符串中间<strong>两个点</strong>隔开，例如[<a href="http://www.baidu.com]。二级域名就是最靠近顶级域名左侧的字段。">www.baidu.com]。二级域名就是最靠近顶级域名左侧的字段。</a></p>
<p><strong>三级域名</strong></p>
<p>二级域名的子域名,特征是包含三个点，例如[mp.weixin.qq.com]。</p>
<ul>
<li>渗透时域名扫描<br>  进行渗透测试时，其主域名找不到漏洞时，就可以尝试去测试收集到的子域名，然后可以由此横向到主网站。<br>  比如layer子域名探测。</li>
</ul>
<h3 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h3><h4 id="本地Hosts与DNS的关系"><a href="#本地Hosts与DNS的关系" class="headerlink" title="本地Hosts与DNS的关系"></a>本地Hosts与DNS的关系</h4><p>Hosts文件主要作用是定义IP地址和主机名的映射关系，是一个映射IP地址和主机名的规定。<br>Hosts文件是一个没有扩展名的系统文件，可以用记事本等工具打开，其作用就是将一些常用的网址域名与其对应的IP地址建立一个关联“数据库”，当用户在浏览器中输入一个需要登录的网址时，系统会首先自动从Hosts文件中寻找对应的IP地址，一旦找到，系统会立即打开对应网页，如果没有找到，则系统会再将网址提交DNS域名解析服务器进行IP地址的解析。</p>
<h4 id="CDN是什么-与DNS的关系"><a href="#CDN是什么-与DNS的关系" class="headerlink" title="CDN是什么?与DNS的关系?"></a>CDN是什么?与DNS的关系?</h4><p>CDN的全称是Content DeliveryNetwork，即内容分发网络。</p>
<p><strong>基本思路</strong></p>
<p>是尽可能避开互联网上有可能影响数据传输速度和稳定性的瓶颈和环节，使内容传输的更快、更稳定。</p>
<p>通过在网络各处放置节点服务器所构成的在现有的互联网基础之上的一层智能虚拟网络，CDN系统能够实时地根据网络流量和各节点的连接、负载状况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务节点上（单纯只使用DNS解析，直接PING就会显示出自己的真实IP，如果又使用CDN，PING出来的IP就不是用户的真实IP而是CDN服务器的IP节点。需要绕过CDN后去找真实IP地址。）</p>
<p><strong>使用CDN的目的</strong></p>
<p>使用户可就近取得所需内容，解决Internet网络拥挤的状况，提高用户访问网站的响应速度。</p>
<h4 id="常见的DNS安全攻击"><a href="#常见的DNS安全攻击" class="headerlink" title="常见的DNS安全攻击"></a>常见的DNS安全攻击</h4><ul>
<li><p><strong>DDoS攻击</strong></p>
<p>  分布式拒绝服务攻击，可以使很多的计算机在同一时间遭受到攻击，使攻击的目标无法正常使用。攻击者可以伪造自己的DNS服务器地址，同时发送大量请求给其他服务器（频繁的DNS解析请求）。其他服务器的回复会被发送到被伪造服务器的真实地址（真实IP对应的受害者收到大量回复），造成该服务器无法处理请求而崩溃。攻击者同样可以通过利用DNS协议中存在的漏洞，恶意创造一个载荷过大的请求，造成目标DNS服务器崩溃。</p>
</li>
<li><p><strong>DNS缓存中毒（DNS欺骗）</strong></p>
<p>  向DNS服务器注入非法网络域名地址<strong>替换</strong>合法地址（修改合法URL在DNS服务S器上的缓存为非法地址），将流量从合法服务器引导至虚假服务器上的攻击方式，而且以后响应的域名请求将会受黑客所控。当这些非法地址进入DNS服务器缓存，用户的浏览器或者邮件服务器访问合法URL时就会自动跳转到DNS指定的非法地址。这种攻击往往被归类为域欺骗攻击(pharming attack)，由此它会导致出现很多严重问题。首先，用户往往会以为登陆的是自己熟悉的网站，而它们却并不是。与钓鱼攻击采用非法URL不同的是，这种攻击使用的是合法的URL地址。<br>  S</p>
</li>
<li><p><strong>域名劫持（DNS重定向）</strong></p>
<p>  通过攻击域名解析服务器（DNS），或伪造域名解析服务器（DNS）的方法，把目标网站域名解析到错误的地址从而实现用户无法访问目标网站的目的。域名劫持一方面可能影响用户的上网体验，用户被引到假冒的网站进而无法正常浏览网页，而用户量较大的网站域名被劫持后恶劣影响会不断扩大；另一方面用户可能被诱骗到冒牌网站进行登录等操作导致泄露隐私数据。</p>
</li>
<li><p><strong>DNS查询嗅探</strong></p>
<p>  利用对DNS的配置信息获取网络环境的信息，为之后的攻击做准备。</p>
<p>  为此，需要对DNS服务器需要采取特别的安全保护措施，在防火墙网络中，分开设置内部DNS服务器和外部DNS服务器，连接外部服务的外部DNS服务器上不留有对外禁止访问的内部网络系统的服务器，做到内外网络服务器分割。</p>
</li>
<li><p><strong>ARP欺骗</strong></p>
<p>  <strong>ARP协议</strong></p>
<p>  在一个局域网内，广播ARP请求包，通过交换机，到达目标IP地址的PC机，从而获取对方的MAC地址。获取到之后会将IP和MAC地址的对应关系存入ARP缓存表，减少大量广播，降低网络拥塞。</p>
<p>  在网络中产生大量的ARP通信量使网络阻塞，攻击者只要持续不断的发出伪造的ARP响应包就能更改目标主机ARP缓存中的IP-MAC条目，造成网络中断或中间人攻击。</p>
<p>  ARP攻击主要是存在于局域网网络中，局域网中若有一台计算机感染ARP病毒，则感染该ARP病毒的系统将会试图通过”ARP欺骗”手段截获所在网络内其它计算机的通信信息，并因此造成网内其它计算机的通信故障。</p>
<p>  比如在攻击机上执行如下命令，就是在告诉主机192.168.42.236，网关192.168.42.2的MAC地址是我，这样网络中就会充斥着这个ARP响应包，使得主机192.168.42.236的网络请求发送到攻击机，无法上网。</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arpspoof -i eth0 -t 192.168.42.236 192.168.42.2</span><br></pre></td></tr></table></figure>
 <img src="https://boneink.github.io/img/netsafe/1.png" />
 - 本机劫持
    
<pre><code>本机的计算机系统被木马或流氓软件感染后，也可能会出现部分域名的访问异常。
</code></pre>
<h3 id="后门"><a href="#后门" class="headerlink" title="后门"></a>后门</h3><ul>
<li><p>概念</p>
<p>  指绕过安全控制而获取对程序或系统访问权的方法。最主要的目的就是方便以后再次秘密进入或者控制系统。</p>
</li>
<li><p>分类</p>
<p>  <strong>网页后门</strong></p>
<p>  一般都是通过服务器上正常的web服务来构造自己的连接方式，便于控制网站，比如现在非常流行的ASP、cgi脚本后门等。</p>
<p>  <strong>线程插入后门</strong></p>
<p>  利用系统自身的某个服务或者线程，将后门程序插入到其中（最流行）。</p>
<p>  <strong>扩展后门</strong></p>
<p>  所谓的“扩展”，是指在功能上有大的提升，比普通的单一功能的后门有更强的使用性，这种后门本身就相当于一个小的安全工具包，能实现非常多的常驻见安全功能，适合新手使用。</p>
<p>  <strong>C&#x2F;S后门（客户端服务器后门）</strong></p>
<p>  和传统的木马程序类似的控制方法，采用“客户端&#x2F;服务端”的控制方式，通过某种特定的访问方式来启动后门进而控制服务器。可以进行脱库、盗取信息。</p>
</li>
<li><p>特点</p>
<p>  即使管理员通过改变所有密码之类的方法来提高安全性，仍然能再次侵入，使再次侵入被发现的可能性减至最低。大多数后门设法躲过日志，大多数情况下即使入侵者正在使用系统也无法显示他已在线。</p>
</li>
</ul>
<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><ul>
<li><p>WEB的组成框架模型</p>
<p>  网站原码、操作系统、中间件（搭建平台，提供服务的）、数据库。</p>
   <img src="https://boneink.github.io/img/netsafe/2.png" />
  </li>
<li><p>各个层面对应的安全测试</p>
<p>  <strong>通信层</strong></p>
<p>  主要测试通信协议的安全，系统开放的端口，其中操作系统提供网络层和数据链路层协议，存在问题的可能性较小，一般关注开源协议已存在漏洞即可，无需重点关注。应用层服务与协议一般由产品形态决定，产品中可以自定义配置相关协议与参数，需要重点关注与测试。</p>
<p>  <strong>应用层</strong></p>
<p>  应用层包含开发人员开发代码，为整个安全测试的核心模块。主要包括web安全测试，源码安全测试。其中web安全测试从web访问服务的维度，偏向黑盒，进行安全测试。源码安全测试从代码的维度，偏向白盒，进行安全测试。</p>
<p>  <strong>系统层</strong></p>
<p>  主要测试操作系统安全，数据库服务安全，web服务器安全，以及其他一些中间件的安全。</p>
<p>  <strong>管理层</strong></p>
<p>  主要包括产品资料的安全测试，安全策略制定，协调各个层面的安全测试以及安全风险的整体评估。</p>
  <img src="https://boneink.github.io/img/netsafe/3.png" /></li>
</ul>
<h2 id="2-数据包扩展"><a href="#2-数据包扩展" class="headerlink" title="2. 数据包扩展"></a>2. 数据包扩展</h2><h3 id="http-x2F-https数据包"><a href="#http-x2F-https数据包" class="headerlink" title="http&#x2F;https数据包"></a>http&#x2F;https数据包</h3><ul>
<li><p><strong>概念</strong></p>
<p>  HTTP协议是超文本传输协议的缩写，英文是Hyper Text Transfer Protocol。它是从WEB服务器传输超文本标记语言(HTML)到本地浏览器的传送协议。设计HTTP最初的目的是为了提供一种发布和接收HTML页面的方法。HTPP有多个版本，目前广泛使用的是HTTP&#x2F;1.1版本。</p>
</li>
<li><p><strong>原理</strong></p>
<p>  HTTP是一个基于TCP&#x2F;IP通信协议来传递数据的协议，传输的数据类型为HTML文件、图片文件、查询结果等。HTTP协议一般用于B&#x2F;S架构，浏览器作为HTTP客户端通过URL向HTTP服务端即WEB服务器发送所有请求。</p>
</li>
<li><p><strong>特点</strong></p>
<p>  http协议支持客户端&#x2F;服务端模式，也是一种请求&#x2F;响应模式的协议。</p>
<p>  <strong>简单快速</strong>：客户向服务器请求服务时，只需传送请求方法和路径。请求方法常用的有GET、HEAD、POST。</p>
<p>  <strong>灵活</strong>：HTTP允许传输任意类型的数据对象。传输的类型由Content-Type加以标记。</p>
<p>  <strong>无连接</strong>：限制每次连接只处理一个请求。服务器处理完请求，并收到客户的应答后，即断开连接，但是却不利于客户端与服务器保持会话连接，为了弥补这种不足，产生了两项记录http状态的技术，一个叫做Cookie,一个叫做Session。</p>
<p>  <strong>无状态</strong>：无状态是指协议对于事务处理没有记忆，服务器并不知道用户身份。如果后续处理需要前面的信息，则必须重传。（或者借助cookie</p>
</li>
</ul>
<h3 id="URI和URL的区别"><a href="#URI和URL的区别" class="headerlink" title="URI和URL的区别"></a>URI和URL的区别</h3><p>HTTP使用统一资源标识符（Uniform Resource Identifiers, URI）来传输数据和建立连接。</p>
<p><strong>URI</strong>：Uniform Resource Identifier 统一资源标识符。用来标示一个具体的资源，可以通过 URI 知道<strong>一个资源是什么</strong>。</p>
<p><strong>URL</strong>：Uniform Resource Location 统一资源定位符。用来定位具体的资源的，标示了一个具体的资源位置，即通过URL知道<strong>一个资源在哪里</strong>。互联网上的每个文件都有一个唯一的URL。</p>
<h3 id="HTTP报文组成"><a href="#HTTP报文组成" class="headerlink" title="HTTP报文组成"></a>HTTP报文组成</h3><p>HTTP报文由三部分组成：<strong>状态行</strong>(请求行 | 响应行)、<strong>首部</strong>、<strong>主体</strong>。<br> <img src="https://boneink.github.io/img/netsafe/4.png" /><br>HTTP报文以状态行开始，跟在后面的是HTTP首部，首部由多个首部字段构成，每行一个首部字段；HTTP首部后是一个空行，然后是报文主体。<br><strong>状态行和首部</strong>中的每行都是以<strong>回车符</strong>(\r，%0d，CR)和<strong>换行符</strong>(\n，%0a，LF)结束，这是因为HTTP规范中行应该使用CRLF结束。另外，首部和主体之间由一空行隔开，或者可以理解为HTTP首部的最后一个字段有两个CRLF。<br>与状态行和首部不同的是，<strong>主体</strong>是可选的，也就是说报文中不一定要有主体；另外状态行和首部是ASCII文本，主体可包含文本或二进制数据。<br>HTTP报文分为请求报文和响应报文；请求报文向服务器传达请求，响应报文将请求的结果返回给客户端。以下两图，分别是请求报文以及响应报文的结构图。<br><img src="https://boneink.github.io/img/netsafe/5.png" /><br><img src="https://boneink.github.io/img/netsafe/6.png" /><br><img src="https://boneink.github.io/img/netsafe/7.png" /><br><img src="https://boneink.github.io/img/netsafe/8.png" /></p>
<h3 id="常见请求方法"><a href="#常见请求方法" class="headerlink" title="常见请求方法"></a>常见请求方法</h3><p>GET：请求指定的页面信息，并返回实体主体。</p>
<p>POST：向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST请求可能会导致新的资源的建立和&#x2F;或已有资源的修改。</p>
<p>HEAD：类似于get请求，只不过返回的响应中没有具体的内容，用于获取报头</p>
<p>PUT：从客户端向服务器传送的数据取代指定的文档的内容。</p>
<p>DELETE：请求服务器删除指定的页面。</p>
<ul>
<li><p><strong>get和post的区别</strong></p>
<p>  get请求：</p>
  <img src="https://boneink.github.io/img/netsafe/9.png" />
  post请求：
  <img src="https://boneink.github.io/img/netsafe/10.png" />
  - 编码和请求方式不同：get通过URL显式的请求，只能是ASCII码。post不会显示在URL，请求的参数存放在请求实体body中（例如提交表单或者上传文件），在报文内部，且编码不唯一；post比get更加安全；
  - 请求的数据量不同：get请求的数据有限，不超过2k-4k（视浏览器而定），而post没有上限；
  - 缓存性：get会进行缓存，而post没有；
  - 可刷新性：get请求可刷新，由于有本地缓存，不会重复请求，而post请求在刷新时会重新提交请求；
  - get多用来查询，请求参数放在url中，不会对服务器上的内容产生作用；post请求可能会导致新的资源的建立和/或已有资源的修改。</li>
</ul>
<h3 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h3><p>HTTP很多信息是明文传输，因此不适合用来传输一些敏感信息，比如：各种账号、密码等信息，使用http协议传输隐私信息非常不安全。存在以下问题：</p>
<ul>
<li>请求信息明文传输，容易被窃听截取。（机密性）</li>
<li>数据的完整性未校验，容易被篡改。（完整性）</li>
<li>没有验证对方身份，存在冒充危险。（不可抵赖性）</li>
</ul>
<p>HTTPS 协议（HyperText Transfer Protocol over Secure Socket Layer）：一般理解为HTTP+SSL&#x2F;TLS，通过 SSL证书来验证服务器的身份（SSL安全套接字层位于传输层和应用层之间），并为浏览器和服务器之间的通信进行加密。<br><img src="https://boneink.github.io/img/netsafe/11.png" /></p>
<ul>
<li><strong>HTTPS的缺点</strong><br>  HTTPS协议多次握手，导致页面的加载时间延长近50%；<br>  HTTPS连接缓存不如HTTP高效，会增加数据开销和功耗；<br>  申请SSL证书需要钱，功能越强大的证书费用越高。<br>  SSL涉及到的安全算法会消耗 CPU 资源，对服务器资源消耗较大。</li>
<li><strong>HTTP和HTTPS的区别</strong><ul>
<li><strong>申请证书</strong>：https协议需要到CA申请证书，一般免费证书较少，因而需要一定费用。</li>
<li><strong>传输数据</strong>：http是超文本传输协议，信息是明文传输，https则是具有安全性的ssl&#x2F;tls加密传输协议。</li>
<li><strong>端口</strong>：http和https使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443。</li>
<li><strong>安全性</strong>：http的连接很简单，是无状态的；HTTPS协议是由SSL&#x2F;TLS+HTTP协议构建的可进行加密传输、身份认证的网络协议，比http协议安全。</li>
</ul>
</li>
</ul>
<h2 id="3-系统及数据库安全"><a href="#3-系统及数据库安全" class="headerlink" title="3. 系统及数据库安全"></a>3. 系统及数据库安全</h2>  <img src="https://boneink.github.io/img/netsafe/12.png" />
### 操作系统层面

<ul>
<li><p>识别操作系统</p>
<p>  <strong>方法一：</strong>网站路径修改大小写</p>
<p>  windows对大小写不敏感，也就是说你在网页中可以替换网站路径的大小写进行测试；</p>
<p>  <strong>方法二：</strong>nmap扫描</p>
<p>  没有网站可以用于测试时，可以使用nmap扫描主机，获得主机的一些信息。如下：</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">──(root💀kali)-[~/桌面]  </span><br><span class="line">└─# nmap -O 10.1.1.10   </span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-07 21:06 CST  </span><br><span class="line">Nmap scan report for 10.1.1.10 (10.1.1.10)  </span><br><span class="line">Host is up (0.0011s latency).  </span><br><span class="line">Not shown: 999 closed ports  </span><br><span class="line">PORT   STATE SERVICE  </span><br><span class="line">22/tcp open  ssh  </span><br><span class="line">MAC Address: 00:0C:29:13:E9:61 (VMware)  </span><br><span class="line">Device type: general purpose  </span><br><span class="line">Running: Linux 3.X|4.X  </span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4  </span><br><span class="line">OS details: Linux 3.2 - 4.9  </span><br><span class="line">Network Distance: 1 hop</span><br></pre></td></tr></table></figure></li>
</ul>
<p>备注：不是所有的系统都可以用这种方式扫描出操作系统的类型、在windows的一些高版本中nmap也无法探测其操作系统类型。</p>
<p> <strong>方法三：</strong>TTL值</p>
<p>不同的操作系统的默认TTL值（网络中数据包的生存周期，经过多少次路由后自动丢弃，经过一次路由就减一）是不同的， 所以我们可以通过TTL值来判断主机的操作系统，但是当用户在注册表中修改了TTL值的时候，就会误导我们的判断，所以这种判断方式也不一定准确。下面是默认操作系统的TTL：</p>
<pre><code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">WINDOWS NT/2000   TTL：128  </span><br><span class="line">WINDOWS 95/98     TTL：32  </span><br><span class="line">UNIX              TTL：255  </span><br><span class="line">LINUX             TTL：64  </span><br><span class="line">WIN7         	  TTL：64</span><br></pre></td></tr></table></figure>
</code></pre>
<p>比如，使用ping命令可以看到TTL为53，可以估计出TTL值原本为64，经过了11次路由。<br>    <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\cbcao&gt;ping baidu.com  </span><br><span class="line">正在 Ping baidu.com [110.242.68.66] 具有 32 字节的数据:  </span><br><span class="line">来自 110.242.68.66 的回复: 字节=32 时间=42ms TTL=53  </span><br><span class="line">来自 110.242.68.66 的回复: 字节=32 时间=42ms TTL=53  </span><br><span class="line">来自 110.242.68.66 的回复: 字节=32 时间=42ms TTL=53  </span><br><span class="line">来自 110.242.68.66 的回复: 字节=32 时间=42ms TTL=53</span><br></pre></td></tr></table></figure><br><strong>方法四</strong>：特殊端口 如（22 &#x2F; 139 &#x2F; 445 &#x2F; 1433 &#x2F; 3389）</p>
<ul>
<li><p>识别操作系统的意义</p>
<p>  不同操作系统对应着不同的漏洞、不同的利用条件。</p>
</li>
</ul>
<h3 id="数据库层面"><a href="#数据库层面" class="headerlink" title="数据库层面"></a>数据库层面</h3><ul>
<li><p>识别数据库的常见方法</p>
<p>  <strong>方法一</strong>：根据搭配的语言进行识别</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">默认的语言搭配的数据库  </span><br><span class="line">组合类型 asp + access/mssql  </span><br><span class="line">组合类型 php + mysql   </span><br><span class="line">组合类型 aspx+mssql  </span><br><span class="line">组合类型 jsp +mysql/oracle  </span><br><span class="line">组合类型 Python + MongoDB</span><br></pre></td></tr></table></figure>

<p> <strong>方法二</strong>：根据端口号进行识别</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">常见的数据库默认端口号  </span><br><span class="line">关系型数据库  </span><br><span class="line">  mysql			3306  </span><br><span class="line">  sqlserver		1433  </span><br><span class="line">  oracle		1521  </span><br><span class="line">  psotgresql	5432  </span><br><span class="line">非关系型数据库  </span><br><span class="line">  MongoDB		27017  </span><br><span class="line">  Redis			6379  </span><br><span class="line">  memcached		11211</span><br></pre></td></tr></table></figure></li>
<li><p>识别数据库的意义<br>  数据库的不同表示的结构也是不同、写法结构也不一样、所以产生的漏洞也不一样。<br>  不同的数据库的攻击方式也不完全一样。</p>
</li>
<li><p>数据库漏洞的影响<br>  数据库权限、网站权限、修改网页内容</p>
</li>
<li><p>漏洞演示<br>  <a target="_blank" rel="noopener" href="https://vulhub.org/#/environments/mysql/CVE-2012-2122/">https://vulhub.org/#/environments/mysql/CVE-2012-2122/</a><br>  首先kali中进入metasploit：<code>msfconsole</code><br>  <a target="_blank" rel="noopener" href="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725164309854.png"><img src="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725164309854.png" alt="image-20220725164309854"></a><br>  然后搜索mysql漏洞：<code>search mysql</code><br>  <a target="_blank" rel="noopener" href="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725204945302.png"><img src="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725204945302.png" alt="image-20220725204945302"></a><br>  选择一个准备利用的漏洞，使用该模块：<br>  <a target="_blank" rel="noopener" href="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725205142250.png"><img src="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725205142250.png" alt="image-20220725205142250"></a><br>  <a target="_blank" rel="noopener" href="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725205202105.png"><img src="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725205202105.png" alt="image-20220725205202105"></a><br>  然后按照rhost选项配置攻击机IP、线程数threads，接着执行run即可：<br>  <a target="_blank" rel="noopener" href="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725205258549.png"><img src="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725205258549.png" alt="image-20220725205258549"></a></p>
<p>  最后得到数据库密码的hash值：</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[+] 10.1.1.133:3306       - 10.1.1.133:3306 Saving HashString as Loot: root:*6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9  </span><br><span class="line">[+] 10.1.1.133:3306       - 10.1.1.133:3306 Hash Table has been saved: /root/.msf4/loot/20210608111341_default_10.1.1.133_mysql.hashes_091970.txt  </span><br><span class="line">[*] 10.1.1.133:3306       - Scanned 1 of 1 hosts (100% complete)  </span><br><span class="line">[*] Auxiliary module execution completed  </span><br><span class="line">  </span><br><span class="line">md5在线解密  </span><br><span class="line">https://www.cmd5.com/</span><br></pre></td></tr></table></figure>
<p>  <a target="_blank" rel="noopener" href="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725205818311.png"><img src="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725205818311.png" alt="image-20220725205818311"></a></p>
</li>
</ul>
<h3 id="第三方层面"><a href="#第三方层面" class="headerlink" title="第三方层面"></a>第三方层面</h3><ul>
<li><p>如何判断有哪些第三方平台或软件：nmap</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">nmap -O -sV 10.1.1.130  </span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-08 09:26 CST  </span><br><span class="line">Nmap scan report for 10.1.1.130 (10.1.1.130)  </span><br><span class="line">Host is up (0.00085s latency).  </span><br><span class="line">Not shown: 978 closed ports  </span><br><span class="line">PORT     STATE SERVICE     VERSION  </span><br><span class="line">21/tcp   open  ftp         vsftpd 2.3.4  </span><br><span class="line">22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)  </span><br><span class="line">23/tcp   open  telnet      Linux telnetd  </span><br><span class="line">25/tcp   open  smtp        Postfix smtpd  </span><br><span class="line">80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)  </span><br><span class="line">111/tcp  open  rpcbind     2 (RPC #100000)  </span><br><span class="line">139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)  </span><br><span class="line">445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)  </span><br><span class="line">512/tcp  open  exec?  </span><br><span class="line">513/tcp  open  login?  </span><br><span class="line">514/tcp  open  tcpwrapped</span><br></pre></td></tr></table></figure>
<ul>
<li>识别第三方平台或软件的意义</li>
</ul>
<p>  不同的第三方软件或工具存在不同的漏洞、识别到更多的信息对收集到的漏洞也就越多。
  </p>
</li>
<li><p>渗透第三方平台或软件的目标</p>
<p>  直接获取到软件的权限便于进一步的提权和攻击</p>
</li>
<li><p>漏洞演示</p>
<p>  <a target="_blank" rel="noopener" href="https://vulhub.org/#/environments/phpmyadmin/CVE-2018-12613/">https://vulhub.org/#/environments/phpmyadmin/CVE-2018-12613/</a></p>
<p>  首先进入该漏洞的目录，启动phpmyadmin：</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hdss7-11 CVE-2018-12613]# pwd  </span><br><span class="line">/opt/vulhub/vulhub-master/phpmyadmin/CVE-2018-12613  </span><br><span class="line">[root@hdss7-11 CVE-2018-12613]# docker-compose up -d</span><br></pre></td></tr></table></figure>
<p>  <a target="_blank" rel="noopener" href="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/1623123783733-3cba9200-6e65-4115-b589-0b777315382c.png"><img src="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/1623123783733-3cba9200-6e65-4115-b589-0b777315382c.png" alt="img"></a></p>
<p>  成功访问phpmyadmin之后，访问<code>http://10.1.1.133:8080/?target=db_sql.php%3f/../../../../../../../../etc/passwd</code>实现漏洞利用，得到执行etc&#x2F;passwd的结果：</p>
<p>  <a target="_blank" rel="noopener" href="https://cdn.nlark.com/yuque/0/2021/png/2476579/1623123853171-a2f0af6d-42bd-483d-a96e-02c553f0f297.png"><img src="https://cdn.nlark.com/yuque/0/2021/png/2476579/1623123853171-a2f0af6d-42bd-483d-a96e-02c553f0f297.png" alt="image.png"></a></p>
</li>
</ul>
<h2 id="4-加密编码算法"><a href="#4-加密编码算法" class="headerlink" title="4. 加密编码算法"></a>4. 加密编码算法</h2><ul>
<li><p>时间戳</p>
<p>  在线转换工具：<a target="_blank" rel="noopener" href="https://tool.lu/timestamp/">https://tool.lu/timestamp/</a></p>
</li>
<li><p>URL编码</p>
<p>  <a target="_blank" rel="noopener" href="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725211231394.png"><img src="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725211231394.png" alt="image-20220725211231394"></a></p>
</li>
<li><p>base64编码</p>
<p>  随着编码的文本增加而增加、由大小写和数字组成且字符结尾一般有两个等号。</p>
</li>
<li><p>unescape编码</p>
<p>  和URL编码有点像，特点是一般是%U+四个数字对应着两个字符，主要运用于网站web应用。</p>
</li>
<li><p>AES加密</p>
</li>
</ul>
<h2 id="5-CDN绕过"><a href="#5-CDN绕过" class="headerlink" title="5. CDN绕过"></a>5. CDN绕过</h2><p>CDN依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。但在安全测试过程中，若目标存在CDN服务，将会影响到后续的安全测试过程。</p>
<ul>
<li><p>判断是否存在CDN服务</p>
<p>  利用多节点技术进行请求返回判断<br>  <a target="_blank" rel="noopener" href="http://ping.chinaz.com/">http://ping.chinaz.com/</a><br>  <a target="_blank" rel="noopener" href="http://ping.aizhan.com/">http://ping.aizhan.com/</a><br>  <a target="_blank" rel="noopener" href="http://ce.cloud.360.cn/">http://ce.cloud.360.cn/</a></p>
<p>  验证获取到ip是否可信可以采用第三方的ip地址查询工具经行验证。</p>
<p>  <a target="_blank" rel="noopener" href="https://get-site-ip.com/">https://get-site-ip.com/</a></p>
<p>  cdn网站</p>
<p>  <a target="_blank" rel="noopener" href="https://tools.ipip.net/cdn.php">https://tools.ipip.net/cdn.php</a></p>
</li>
<li><p>CDN对安全测试的影响</p>
<p>  CDN会隐藏服务器真实的ip地址，无法对目标网站的操作系统进行渗透，但CDN站点又可以理解为是目标站点的镜像站点（大多数都是静态cdn加速），拥有相同的网站架构，且cdn服务器可与站点服务器进行交互，因此sql注入，xss等漏洞的挖掘并不受太大影响。</p>
</li>
<li><p>目前常见的CDN绕过技术</p>
<p>  <strong>子域名查询</strong></p>
<p>  因为有些主站是做了CDN服务而子站是没有做CDN服务</p>
<p>  <strong>邮件服务查询</strong></p>
<p>  因为邮箱大部分都是内部人在访问、而且访问的量也不是很大，一般是没有做CDN。</p>
<p>  <strong>国外地址请求</strong></p>
<p>  因为很多的企业没有在国外部署CDN，要是用国外的地址请求、就容易找到他的真实地址。</p>
<p>  <strong>遗留文件、扫描全网</strong></p>
<p>  如PHPinfo信息当中会遗留出ip地址</p>
<p>  <strong>黑暗引擎搜索</strong></p>
<p>  fofa、傻蛋、谛听、zoomeye、censys</p>
<p>  <strong>特定文件dns历史记录，以量打量</strong></p>
<p>  CDN真实IP地址获取后绑定指向地址，即更改本地HOSTS解析指向文件</p>
<p>  <strong>奇淫技巧</strong></p>
<p>  fackcdn w8fuckcdn zmap</p>
</li>
</ul>
<h2 id="6-信息收集、WAF"><a href="#6-信息收集、WAF" class="headerlink" title="6. 信息收集、WAF"></a>6. 信息收集、WAF</h2><h3 id="站点搭建分析"><a href="#站点搭建分析" class="headerlink" title="站点搭建分析"></a>站点搭建分析</h3><ul>
<li><p>目录型站点</p>
<p>  主站上面存在其他的cms程序。</p>
<p>  比如学生网站[<a href="http://www.xxx.com]的上面通过后台扫描探针发现有一个bbs的目录，一点击发现是一个bbs的论坛网站如：www.xxx.com/bbs。我们把这个称为目录型网站，可以有两种找到漏洞的思路，一个是主站的漏洞另外的一个是bbs上面的漏洞。">www.xxx.com]的上面通过后台扫描探针发现有一个bbs的目录，一点击发现是一个bbs的论坛网站如：www.xxx.com/bbs。我们把这个称为目录型网站，可以有两种找到漏洞的思路，一个是主站的漏洞另外的一个是bbs上面的漏洞。</a></p>
</li>
<li><p>端口类站点</p>
<p>  有的站点不是使用的是默认的站点80而是其他的端口，可以使用shodan这种工具去收集端口。</p>
</li>
<li><p>子域名站点</p>
<p>  比如bbs.goodlift.net是goodlift.net的子域名，且为不同的站点。</p>
<p>  现在的主流网站都是采用的这种模式且子域名和网站之间很有可能是不在同一台的服务器上面。</p>
</li>
<li><p>类似域名站点</p>
<p>  例如：京东的网站是jd.com 那么他就有可能是采用了jd.net jd.cn等域名我们采用社工的方式去尝试获取他的相关域名信息。</p>
</li>
<li><p>旁注，c段站点</p>
<p>  <strong>旁注</strong>：同一个服务器上面存在多个站点、但是你要攻击的是A网站由于各种原因不能完成安全测试。就通过测试B网站进入服务器然后在攻击A网站最终实现目的。</p>
<p>  <strong>C段</strong>：不同的服务器上面存在不同的网站，通过扫描发现与你渗透测试的是同一个网段，最终拿下服务器，然后通过内网渗透的方式拿下渗透服务器。</p>
<p>  查询服务器上站点：在线工具：<a target="_blank" rel="noopener" href="https://www.webscan.cc/">https://www.webscan.cc/</a></p>
</li>
<li><p>搭建软件特征站点</p>
<p>  有的网站是借助于第三方的集成搭建工具实现，例如：PHPstudy、宝塔等环境。这样的集成环境搭建的危害就是泄露了详细的版本信息。</p>
<p>  phpstudy搭建了之后，在默认的站点安装了phpmyadmin。有的网站没有做安全性直接可以通过用户名：root密码：root 登录进入。</p>
</li>
</ul>
<h3 id="WAF"><a href="#WAF" class="headerlink" title="WAF"></a>WAF</h3><p>Web应用防护系统（也称为：网站应用级入侵防御系统。英文：Web Application Firewall，简称： WAF）。利用国际上公认的一种说法：Web应用防火墙是通过执行一系列针对HTTP&#x2F;HTTPS的安全策略来专门为Web应用提供保护的一款产品。</p>
<p><strong>识别WAF的存在</strong>：直接使用工具进行扫描有可能会导致waf将你的ip地址拉入黑名单而不能访问，针对不同的厂商的waf可能存在着不同的绕过思路。</p>
<ul>
<li><p>采用工具wafwoof，缺点是并不特别准确</p>
<p>  获取地址：<a target="_blank" rel="noopener" href="https://codeload.github.com/EnableSecurity/wafw00f/zip/refs/heads/master">https://codeload.github.com/EnableSecurity/wafw00f/zip/refs/heads/master</a></p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">unzip wafw00f-master.zip      <span class="comment"># 解压</span></span>  </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">python3.8 setup.py install    <span class="comment"># 安装</span></span>  </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">ls</span> -ld wafw00f</span>  </span><br><span class="line">drwxr-xr-x 6 root root 4096  6月 10 17:22 wafw00f  </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> wafw00f</span>   </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python main.py https://www.hlszsb.com/   <span class="comment"># 识别网站https://www.hlszsb.com/</span></span>  </span><br><span class="line">  </span><br><span class="line">[*] Checking https://www.hlszsb.com/  </span><br><span class="line">[+] Generic Detection results:  </span><br><span class="line">[-] No WAF detected by the generic detection  </span><br><span class="line">[~] Number of requests: 7</span><br></pre></td></tr></table></figure>
<ul>
<li>identYwaf</li>
</ul>
<p>  参考地址：<a target="_blank" rel="noopener" href="https://github.com/stamparm/identywaf">https://github.com/stamparm/identywaf</a></p>
<p>  与wafwoof相比运行速度慢，但是比较稳定
  </p>
</li>
<li><p>在有些网站的请求信息当中留下了waf的相关信息</p>
<p>  <a target="_blank" rel="noopener" href="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725213558764.png"><img src="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725213558764.png" alt="image-20220725213558764"></a></p>
</li>
<li><p>nmap</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmap --script==http-waf-fingerprint  </span><br><span class="line">nmap --script=http-waf-detect</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="7-资产收集"><a href="#7-资产收集" class="headerlink" title="7. 资产收集"></a>7. 资产收集</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># Github监控  </span><br><span class="line">  便于收集整理最新exp或poc  </span><br><span class="line">  便于发现相关测试目标的资产  </span><br><span class="line">  server酱：http://sc.ftqq.com/3.version  </span><br><span class="line">  GitHub项目监控地址：https://github.com/weixiao9188/wechat_push  </span><br><span class="line">  </span><br><span class="line"># 各种子域名查询  </span><br><span class="line"># DNS,备案,证书  </span><br><span class="line"># 全球节点请求cdn  </span><br><span class="line">  枚举爆破或解析子域名对应  </span><br><span class="line">  便于发现管理员相关的注册信息  </span><br><span class="line">  </span><br><span class="line">#黑暗引擎相关搜索  </span><br><span class="line">	fofa, shodan, zoomeye  </span><br></pre></td></tr></table></figure>
<h2 id="8-web漏洞"><a href="#8-web漏洞" class="headerlink" title="8. web漏洞"></a>8. web漏洞</h2><p><a target="_blank" rel="noopener" href="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725233424804.png"><img src="https://frankcao3-picgo.oss-cn-shenzhen.aliyuncs.com/img/image-20220725233424804.png" alt="image-20220725233424804"></a></p>
<p><strong>漏洞危害情况</strong></p>
<ol>
<li>获取网站的数据库的权限（数据），后台账号和密码—SQL注入</li>
<li>直接获取网站权限—文件上传</li>
</ol>
<p><strong>漏洞等级划分</strong></p>
<ol>
<li>高危：文件上传、SQL注入、代码执行、文件包含、未授权访问</li>
<li>中危：逻辑安全、目录遍历</li>
<li>低危：信息泄露—源码、部分账号密码</li>
</ol>
<p><strong>漏洞重点内容</strong></p>
<ol>
<li>CTF：SQL注入、反序列化、代码执行</li>
<li>SRC：以上都有，逻辑安全</li>
<li>红蓝对抗：高危漏洞—权限</li>
</ol>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">BoneInk</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://boneink.github.io/2021/08/01/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/">https://boneink.github.io/2021/08/01/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://boneink.github.io" target="_blank">临渊羡鱼</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a><a class="post-meta__tags" href="/tags/Web%E5%AE%89%E5%85%A8/">Web安全</a><a class="post-meta__tags" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2021/08/10/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-SQL%E6%B3%A8%E5%85%A5-WAF%E7%BB%95%E8%BF%87/"><img class="prev_cover" src="https://https://www.wallpaperup.com/uploads/wallpapers/2014/09/25/455966/2587c9e290e4776a126065c9eeb18090.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">渗透测试-信息收集</div></div></a></div><div class="next-post pull_right"><a href="/2021/07/13/Web%E5%AE%89%E5%85%A8-XSS%E6%94%BB%E5%87%BB%E6%B8%97%E9%80%8F%E6%8A%A5%E5%91%8A/"><img class="next_cover" src="https://https://www.wallpaperup.com/uploads/wallpapers/2014/09/25/455966/2587c9e290e4776a126065c9eeb18090.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Web安全-XSS攻击渗透报告</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2021/08/10/渗透测试-SQL注入-WAF绕过/" title="渗透测试-信息收集"><img class="relatedPosts_cover" src="https://https://www.wallpaperup.com/uploads/wallpapers/2014/09/25/455966/2587c9e290e4776a126065c9eeb18090.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-08-10</div><div class="relatedPosts_title">渗透测试-信息收集</div></div></a></div><div class="relatedPosts_item"><a href="/2021/06/27/Web安全-DOM型XSS攻击实战/" title="Web安全-命令注入攻击实战"><img class="relatedPosts_cover" src="https://https://www.wallpaperup.com/uploads/wallpapers/2014/09/25/455966/2587c9e290e4776a126065c9eeb18090.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-06-27</div><div class="relatedPosts_title">Web安全-命令注入攻击实战</div></div></a></div><div class="relatedPosts_item"><a href="/2021/06/15/Web安全-SQL注入/" title="Web安全-SQL注入"><img class="relatedPosts_cover" src="https://https://www.wallpaperup.com/uploads/wallpapers/2014/09/25/455966/2587c9e290e4776a126065c9eeb18090.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-06-15</div><div class="relatedPosts_title">Web安全-SQL注入</div></div></a></div><div class="relatedPosts_item"><a href="/2021/07/12/Web安全-SQL注入爆表/" title="Web安全-SQL注入爆表"><img class="relatedPosts_cover" src="https://https://www.wallpaperup.com/uploads/wallpapers/2014/09/25/455966/2587c9e290e4776a126065c9eeb18090.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-07-12</div><div class="relatedPosts_title">Web安全-SQL注入爆表</div></div></a></div><div class="relatedPosts_item"><a href="/2021/06/20/Web安全-Web爆破攻击实战/" title="Web安全-Web爆破攻击实战"><img class="relatedPosts_cover" src="https://https://www.wallpaperup.com/uploads/wallpapers/2014/09/25/455966/2587c9e290e4776a126065c9eeb18090.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-06-20</div><div class="relatedPosts_title">Web安全-Web爆破攻击实战</div></div></a></div><div class="relatedPosts_item"><a href="/2021/06/30/Web安全-反射型XSS攻击实战/" title="Web安全-反射型XSS攻击实战"><img class="relatedPosts_cover" src="https://https://www.wallpaperup.com/uploads/wallpapers/2014/09/25/455966/2587c9e290e4776a126065c9eeb18090.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-06-30</div><div class="relatedPosts_title">Web安全-反射型XSS攻击实战</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2024 By BoneInk</div><div class="framework-info"><span>驱动 </span><a target="_blank" rel="noopener" href="https://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div><div class="footer_custom_text">OK, stop! It's over.</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script></body></html>